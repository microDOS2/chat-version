<!DOCTYPE html>
<html lang="en">
<head>
  <title>Admin — Orders Dashboard</title>
  
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<style>
  :root{
    --slate-900:#0b1020; --slate-850:#111833; --slate-800:#17243a; --slate-750:#1d2c48;
    --slate-700:#25344f; --slate-600:#2f415f; --slate-500:#4b5f86; --slate-400:#94a3b8; --slate-300:#cbd5e1; --white:#ffffff;
    --sky-300:#7dd3fc; --sky-400:#38bdf8; --violet-500:#8b5cf6; --pink-500:#ec4899; --green-500:#22c55e; --red-500:#ef4444;
  }
  *{box-sizing:border-box}
  html{scroll-behavior:smooth}
  body{margin:0;font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Arial,sans-serif;background:var(--slate-900);color:var(--slate-300);}
  .container{max-width:1200px;margin:0 auto;padding:0 24px}
  .header{position:sticky;top:0;z-index:50;background:rgba(11,16,32,.75);backdrop-filter:blur(8px);border-bottom:1px solid #0f1a33}
  .row{display:flex;align-items:center;justify-content:space-between;padding:14px 0}
  a{color:inherit}
  nav a{color:#cbd5e1;text-decoration:none;margin:0 10px;padding:8px 10px;border-radius:10px;transition:background .2s}
  nav a:hover{background:#1a2a4a;color:#fff}
  .brand{color:#fff;font-weight:900;letter-spacing:.3px}
  .grad{background:linear-gradient(90deg,var(--sky-400),var(--violet-500));-webkit-background-clip:text;background-clip:text;color:transparent}
  .btn{display:inline-block;padding:12px 16px;border-radius:12px;background:linear-gradient(90deg,var(--sky-400),var(--violet-500));color:#fff;font-weight:800;text-decoration:none;border:none;cursor:pointer}
  .btn.secondary{background:#2a3a5f;border:1px solid #3a4a6f}
  .btn.ghost{background:transparent;border:1px solid #384766}
  .section{padding:72px 0}
  .title{color:#fff;font-weight:900;margin:0 0 10px;font-size:42px;letter-spacing:-.02em}
  .subtitle{max-width:860px;margin:0 auto 6px;color:var(--slate-300);font-size:18px}
  .card{background:var(--slate-800);border:1px solid #152238;border-radius:16px;padding:24px}
  .grid{display:grid;gap:24px}
  .grid-2{grid-template-columns:repeat(2,1fr)}
  .grid-3{grid-template-columns:repeat(3,1fr)}
  .grid-4{grid-template-columns:repeat(4,1fr)}
  @media(max-width:900px){.grid-2,.grid-3,.grid-4{grid-template-columns:1fr} .title{font-size:32px}}
  .kpi{background:rgba(30,41,59,.6);border-radius:12px;padding:16px;text-align:center}
  .kpi .label{color:var(--slate-400);font-size:13px}
  .kpi .value{color:#fff;font-weight:800;font-size:20px}
  .footer{border-top:1px solid #1b2641;color:var(--slate-500);text-align:center;padding:36px 0;margin-top:48px}
  /* Toast */
  .toast{position:fixed;top:18px;left:50%;transform:translateX(-50%) translateY(-150%);background:#14223d;color:#e2e8f0;padding:12px 16px;border-radius:10px;border:1px solid #2a3a5c;box-shadow:0 14px 40px rgba(0,0,0,.25);z-index:1000;transition:transform .5s}
  .toast.show{transform:translateX(-50%) translateY(0)}
</style>
<script>
function showToast(msg){
  const t = document.getElementById('toast'); if(!t) return;
  t.textContent = msg; t.classList.add('show');
  setTimeout(()=>t.classList.remove('show'), 2500);
}
</script>

  <style>
    .table{{width:100%;border-collapse:collapse}}
    .table th,.table td{{border-bottom:1px solid #223251;padding:10px;text-align:left;font-size:14px}}
    .tag{{display:inline-block;padding:4px 8px;border-radius:8px;background:#1b2a44;border:1px solid #28416b}}
    input,select{{background:#132141;border:1px solid #293a5f;color:#e2e8f0;border-radius:8px;padding:8px}}
  </style>
</head>
<body>
  
<header class="header">
  <div class="container row">
    <div class="brand">microDOS<span class="grad">(2)</span></div>
    <nav>
      <a href="index.html">Home</a>
      <a href="metocin.html">What is Metocin?</a>
      <a href="microdosing.html">Microdosing Guide</a>
      <a href="stories.html">User Stories</a>
      <a href="admin.html">Admin</a>
    </nav>
  </div>
</header>
<div id="toast" class="toast" role="status" aria-live="polite"></div>

  <main class="section">
    <div class="container">
      <h1 class="title" style="font-size:32px">Orders Dashboard</h1>
      <p class="subtitle">Local, client-side records created by checkout. Export CSV for your CRM, or email selected rows.</p>

      <div class="card" id="ordersCard">
        <div style="display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin-bottom:12px">
          <button class="btn" onclick="refresh()">Refresh</button>
          <button class="btn ghost" onclick="exportCSV()">Export CSV</button>
          <button class="btn secondary" onclick="clearAll()">Clear All</button>
          <span class="tag" id="countTag">0 orders</span>
          <div style="margin-left:auto">
            <input id="search" placeholder="Search…" oninput="render()">
          </div>
        </div>
        <div style="overflow:auto">
          <table class="table" id="ordersTable">
            <thead><tr>
              <th>Order ID</th><th>Created</th><th>Plan</th><th>Name</th><th>Email</th><th>City</th><th>Consent</th><th>Status</th>
            </tr></thead>
            <tbody></tbody>
          </table>
        </div>
      </div>
    </div>
  </main>
  <footer class="footer">© 2025 microDOS(2). All rights reserved.</footer>

<script>
const KEY='microdos_orders';
function refresh(){{ render(); }}
function getAll(){{ return JSON.parse(localStorage.getItem(KEY)||'[]'); }}
function render(){{
  const q=(document.getElementById('search').value||'').toLowerCase();
  const data=getAll().filter(r=> JSON.stringify(r).toLowerCase().includes(q));
  const tb=document.querySelector('#ordersTable tbody'); tb.innerHTML='';
  data.forEach(r=>{{
    const tr=document.createElement('tr');
    tr.innerHTML=`<td>${{r['orderId']}}</td>
      <td>${{r['createdAt']}}</td>
      <td>${{r['plan']}}</td>
      <td>${{r['firstName']}} ${{r['lastName']}}</td>
      <td>${{r['email']}}</td>
      <td>${{r['city']}}</td>
      <td>${{r['consentStorePayment']?'Yes':'No'}}</td>
      <td>${{r['status']||'paid_simulated'}}</td>`;
    tb.appendChild(tr);
  }});
  document.getElementById('countTag').textContent = data.length + ' orders';
}}
function exportCSV(){{
  const data=getAll();
  if(!data.length) return alert('No orders to export.');
  const cols = Object.keys(data[0]);
  const lines = [cols.join(',')].concat(data.map(r=> cols.map(c=>`"${{String(r[c]).replaceAll('"','""')}}"`).join(',')));
  const blob = new Blob([lines.join('\n')], {{type:'text/csv'}});
  const url = URL.createObjectURL(blob);
  const a = document.createElement('a');
  a.href = url; a.download = 'microdos_orders.csv'; a.click();
  URL.revokeObjectURL(url);
}}
function clearAll(){{
  if(confirm('Clear all local orders?')){{ localStorage.removeItem(KEY); render(); showToast('Cleared.'); }}
}}
window.addEventListener('DOMContentLoaded', render);
</script>
</body>
</html>
